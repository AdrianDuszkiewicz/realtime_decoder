rank:
  supervisor: [0]
  gui: [2]
  encoders: [4]
  #encoders: [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]
  decoders: [1]
  ripples: [3]

files:
  output_dir: ./output
  prefix: demo
  rec_postfix: bin_rec      # required by MainManager
  timing_postfix: timing    # also expected in some places

algorithm: "clusterless_decoder"
datasource: "openephys"    # still required but ignored when skipping
num_setup_messages: 50
preloaded_model: false
frozen_model: false

encoder:
  spk_amp: 10
  mark_dim: 4
  vel_thresh: 2
  timings_bufsize: 50000   # ← new
  bufsize: 50000
  num_pos_points: 60
  use_channel_dist_from_max_amp: false   # ← add this
  position:
    num_bins: 60   # required by Posterior message dtype
    lower: 0
    upper: 360 #1
    arm_ids: [ 0 ]        # ← must be list of ints
    arm_coords: [ [ 0, 59] ]  # ← Nx2; covers all bins for HD, [0 59]
  mark_kernel:
    std: 20.0
    use_filter: false
    n_std: 3
    n_marks_min: 1

trode_selection:
  ripples: [0]
  decoding: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]
  #decoding: [0,1,2,3]


decoder_assignment:
  # key is the decoder rank. the list consists of
  # the decoding trodes
  1: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]
  #1: [0,1,2,3]

stimulation:
  instructive: false
  shortcut_msg_on: true
  num_pos_points: 10
  center_well_loc: [0, 0]
  max_center_well_dist: 1
  replay:
    enabled: false
    method: "posterior"
    target_arm: 0
    event_lockout: 0.2
    sliding_window: 5
    primary_arm_threshold: 0.4
    secondary_arm_threshold: 0.4
    other_arm_threshold: 0.25
    max_arm_repeats: 1
    instr_max_repeats: 1
    min_unique_trodes: 1
  ripples:
    enabled: false
    type: "standard"
    method: "multichannel"
    event_lockout: 0
    num_above_thresh: 1
    timestamp_only: true
  head_direction:
    enabled: false
    rotate_180: false
    event_lockout: 10
    min_duration: 2
    well_angle_range: 3
    within_angle_range: 25
    well_loc: [[0, 0]]

rank_settings:
  #enable_rec: [0,1,3,4]
  enable_rec: [0,1,3,4]

clusterless_decoder:
  transmat_bias: 1
  state_labels: ['hd']

decoder:
  bufsize: 2000
  timings_bufsize: 50000
  cred_int_bufsize: 10
  num_pos_points: 60 #10
  time_bin:
    samples: 4000
    delay_samples: 100

process_monitor:
  interval: 0   # seconds
  timeout: 3     # seconds

gui:
  colormap: 'viridis'
  send_interval: 0
  refresh_rate: 25
  trace_length: 2
  state_colors: ['#4c72b0']
  num_xticks: 5
  likelihood:
    enabled: false

sampling_rate:
  spikes: 20000
  lfp: 2000
  position: 100

ripples:
  filter:
    type: 'iir'
    order: 2
    crit_freqs: [150, 250]
    kwargs:
      btype: 'bandpass'
      ftype: 'butter'
  timings_bufsize: 50000
  max_ripple_samples: 450
  vel_thresh: 10
  freeze_stats: false
  threshold:
    standard: 3.5
    conditioning: 3.75
    content: 4
    end: 0
  method: multichannel   # or consensus
  smoothing_filter:
    desired: [1, 0]
    band_edges: [100, 250]
    num_taps: 101
    cutoff_freq: 50.0     # or whatever the code expects
    type: 'fir'

kinematics:
  scale_factor: 1.0
  smoothing_filter: [1.0]   # identity FIR filter
  smooth_x: false
  smooth_y: false
  smooth_speed: false

openephys:
  config_file: dummy.trodesconf
  taskstate_file: dummy_taskstate.txt
  instructive_file: dummy_instructive.txt
  voltage_scaling_factor: 1

cred_interval:
  val: 0.5
  max_num: 5

display:
  decoder:
    occupancy: 100
    total_spikes: 50000
    posterior: 5000
  encoder:
    encoding_spikes: 5000
    total_spikes: 10000
    occupancy: 5000
    position: 5000
  ripples:
    lfp: 100000